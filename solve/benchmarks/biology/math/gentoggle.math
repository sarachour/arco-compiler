name "genetic toggle switch with E.coli"

% https://www.ebi.ac.uk/biomodels-main/BIOMD0000000507%_45b73793-03c6-4146-9ac1-3b498b4d4ea1
% 3 diffeqs


type M
type kmol
type s

time t : s

%param a2 : M/s = 15.6
%param a1 : M/s = 156.25

param a1 : M/s = 15.6
param a2 : M/s = 56.25


%param K : kmol = 0.0029618

param nu : unit = 2.0015
%param beta : unit = 2.5
param beta : unit = 1.0
param gamma : unit = 1.0

param Cv : unit = 1
param Cu : 1/M  = 1
param kdeg : (M/s) = 1

%
output U : unit 
output V : unit 
local umodif : unit 
local UTF : unit
local VTF : unit
%

input IPTG : kmol
def IPTG mag = [0,0.60] kmol

input K : kmol
def K mag = [0.29618,0.6000] kmol 
input K2 : kmol
def K2 mag = [5,5] kmol

rel umodif = (U)*(1/((1+(IPTG/K))^nu))

rel UTF = (Cu*a1)*((K2^beta)/((K2^beta) +(V^beta)))

rel VTF = (Cv*a2)*((K2^gamma)/((K2^gamma) + (umodif^gamma)))
%
rel ddt U =  (UTF)/Cu - (kdeg*U) init 0.0
def U mag = [0,56.25] unit
%
rel ddt V = (VTF)/Cv - (kdeg*V) init 0.0
def V mag = [0,15.6] unit 

def ddt V sample 1000 s
% the speed (in wall clock time) should be one ms of real time at most
def ddt V speed 1000 ms 
