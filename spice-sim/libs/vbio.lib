.INCLUDE magnz.hl

* F = current controlled current, E voltage controlled current
* http://web.stanford.edu/class/ee133/handouts/general/spice_ref.pdf


.SUBCKT integ 1 2
  R1 1 3 1u
  VC 3 4
  BC 4 2 V = (1*v(int))
  BINT 0 INT I=I(VC)
  CINT INT 0 1
.ENDS integ


.SUBCKT mm ET ST Kf Kr ES E S ES0

  BE 0 E V=V(ET)
  BS 0 S V=V(ST)

  RE ET E 0
  RS ST S 0
  VS 0 VSRC DC 1

  * generate a current to integrate
  BSRC XS 0 V=V(Kf)*V(ET)*V(ST)+V(Kr)*V(ES0)
  XINT 0 ES integ

.ENDS mm



.SUBCKT iout A B
  ROUT A B 0
.ENDS iout


.SUBCKT iin A B
  RIN A B 0
.ENDS iin
